<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interruptor Animado — PokéAPI</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div class="switch-ui">
    <label for="switchCheckbox">Encender luz y cargar Pokémon</label>
    <input type="checkbox" id="switchCheckbox" aria-label="Interruptor" />
  </div>

  <button class="big-button">¿Qué tipo de Pokémon eres?</button>

  <div class="toggle" aria-hidden="true"></div>

  <div id="pokemon" class="pokemon-card" aria-live="polite">
    <h2 id="poke-name"></h2>
    <img id="poke-img" src="" alt="Imagen del Pokémon" />
    <p id="poke-type"></p>
  </div>

  <script>
    async function loadPokemon() {
      const card = document.getElementById('pokemon');
      try {
        const id = Math.floor(Math.random() * 151) + 1;
        const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
        if (!response.ok) throw new Error('Error al obtener datos de la API');
        const data = await response.json();

        document.getElementById('poke-name').textContent =
          data.name ? data.name.toUpperCase() : 'N/A';

        const sprite = data.sprites?.front_default || '';
        document.getElementById('poke-img').src =
          sprite ||
          'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150"><rect width="100%" height="100%" fill="%23000"/><text x="50%" y="50%" font-size="18" fill="%23fff" text-anchor="middle" dominant-baseline="middle">sin imagen</text></svg>';

        const firstType = data.types?.[0]?.type?.name ?? 'desconocido';
        document.getElementById('poke-type').textContent = 'Tipo: ' + firstType;

        card.style.display = 'block';
      } catch (err) {
        console.error(err);
        document.getElementById('poke-name').textContent = 'Error al cargar';
        document.getElementById('poke-img').src =
          'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150"><rect width="100%" height="100%" fill="%23000"/><text x="50%" y="50%" font-size="14" fill="%23fff" text-anchor="middle" dominant-baseline="middle">error</text></svg>';
        document.getElementById('poke-type').textContent = '';
        card.style.display = 'block';
      }
    }

    function toggleLight(isOn) {
      document.documentElement.style.setProperty('--on', isOn ? 1 : 0);
      const card = document.getElementById('pokemon');

      if (isOn) loadPokemon();
      else card.style.display = 'none';
    }

    const checkbox = document.getElementById('switchCheckbox');
    checkbox.addEventListener('change', (e) => toggleLight(e.target.checked));
    toggleLight(checkbox.checked);
  </script>

</body>

</html>